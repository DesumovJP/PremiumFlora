# Розрахунок повної собівартості квітів

## Формула

```
fullCost = (basePrice + airPerStem + truckPerStem) × (1 + transferFee%) + taxPerStem
```

Де:
- `basePrice` — ціна квітки з Excel (колонка PRECIO)
- `airPerStem` — авіа доставка за квітку = `(transport / totalBoxes) / stemsInBox`
- `truckPerStem` — трак за квітку = `truckCostPerBox / stemsInBox`
- `transferFee%` — комісія за переказ (default: 3.5%)
- `taxPerStem` — податок за квітку (default: 0.05$)

---

## Приклад: файл `15  14,12,2025.xls`

### Вхідні параметри

| Параметр | Значення | Джерело |
|----------|----------|---------|
| Transport | 903.01$ | Рядок "Transport" в Excel |
| Total FB | 3.5 | Підсумковий рядок Excel |
| Total Boxes | 7 | FB × 2 |
| Air per Box | 129.00$ | transport / totalBoxes |
| Truck per Box | 75$ | Параметр UI (default) |
| Transfer Fee | 3.5% | Параметр UI (default) |
| Tax per Stem | 0.05$ | Параметр UI (default) |

### Коробки (CULTIVOS)

| Коробка | Кількість квіток | Air/stem | Truck/stem |
|---------|------------------|----------|------------|
| EVERBLOOM s o | 350 шт | 0.369$ | 0.214$ |
| EVERBLOOM | 350 шт | 0.369$ | 0.214$ |
| GREEN SOUL | 425 шт | 0.304$ | 0.176$ |
| AZAYA | 350 шт | 0.369$ | 0.214$ |
| FINO | 350 шт | 0.369$ | 0.214$ |
| LIFE | 340 шт | 0.379$ | 0.221$ |
| EDANA | 500 шт | 0.258$ | 0.150$ |

---

## Розрахунок по кожній квітці

### Коробка: EVERBLOOM s o (350 stems)

**airPerStem** = 129.00$ / 350 = **0.369$**
**truckPerStem** = 75$ / 350 = **0.214$**

| Квітка | Розмір | К-ть | База | +Авіа | +Трак | Сума | ×1.035 | +Под | **Собівартість** |
|--------|--------|------|------|-------|-------|------|--------|------|------------------|
| FREEDOM | 90cm | 350 | 0.62$ | 0.369$ | 0.214$ | 1.203$ | 1.245$ | 0.05$ | **1.29$** |

### Коробка: EVERBLOOM (350 stems)

**airPerStem** = 129.00$ / 350 = **0.369$**
**truckPerStem** = 75$ / 350 = **0.214$**

| Квітка | Розмір | К-ть | База | +Авіа | +Трак | Сума | ×1.035 | +Под | **Собівартість** |
|--------|--------|------|------|-------|-------|------|--------|------|------------------|
| PINK FLOYD | 90cm | 100 | 0.70$ | 0.369$ | 0.214$ | 1.283$ | 1.328$ | 0.05$ | **1.38$** |
| POMAROSA | 90cm | 150 | 0.80$ | 0.369$ | 0.214$ | 1.383$ | 1.431$ | 0.05$ | **1.48$** |
| POLAR | 90cm | 25 | 0.75$ | 0.369$ | 0.214$ | 1.333$ | 1.380$ | 0.05$ | **1.43$** |
| POLAR | 80cm | 75 | 0.65$ | 0.369$ | 0.214$ | 1.233$ | 1.276$ | 0.05$ | **1.33$** |

### Коробка: GREEN SOUL (425 stems)

| Квітка | Розмір | К-ть | База | +Авіа | +Трак | Сума | ×1.035 | +Под | **Собівартість** |
|--------|--------|------|------|-------|-------|------|--------|------|------------------|
| FRUTETTO | 60cm | 75 | 0.33$ | 0.304$ | 0.176$ | 0.810$ | 0.838$ | 0.05$ | **0.89$** |
| FRUTETTO | 70cm | 50 | 0.47$ | 0.304$ | 0.176$ | 0.950$ | 0.983$ | 0.05$ | **1.03$** |
| IGUAZU | 90cm | 25 | 0.53$ | 0.304$ | 0.176$ | 1.010$ | 1.045$ | 0.05$ | **1.10$** |
| IGUAZU | 80cm | 75 | 0.47$ | 0.304$ | 0.176$ | 0.950$ | 0.983$ | 0.05$ | **1.03$** |
| KAHALA | 60cm | 50 | 0.41$ | 0.304$ | 0.176$ | 0.890$ | 0.921$ | 0.05$ | **0.97$** |
| PALOMA | 70cm | 50 | 0.47$ | 0.304$ | 0.176$ | 0.950$ | 0.983$ | 0.05$ | **1.03$** |
| MONDIAL | 60cm | 100 | 0.37$ | 0.304$ | 0.176$ | 0.850$ | 0.880$ | 0.05$ | **0.93$** |

### Коробка: AZAYA (350 stems)

| Квітка | Розмір | К-ть | База | +Авіа | +Трак | Сума | ×1.035 | +Под | **Собівартість** |
|--------|--------|------|------|-------|-------|------|--------|------|------------------|
| CANDY EXPRESSION | 70cm | 100 | 0.50$ | 0.369$ | 0.214$ | 1.083$ | 1.121$ | 0.05$ | **1.17$** |
| DRAGON FLY | 60cm | 50 | 0.35$ | 0.369$ | 0.214$ | 0.933$ | 0.966$ | 0.05$ | **1.02$** |
| PINK EXPRESSION | 60cm | 100 | 0.35$ | 0.369$ | 0.214$ | 0.933$ | 0.966$ | 0.05$ | **1.02$** |
| SILANTOI | 70cm | 100 | 0.55$ | 0.369$ | 0.214$ | 1.133$ | 1.173$ | 0.05$ | **1.22$** |

### Коробка: FINO (350 stems)

| Квітка | Розмір | К-ть | База | +Авіа | +Трак | Сума | ×1.035 | +Под | **Собівартість** |
|--------|--------|------|------|-------|-------|------|--------|------|------------------|
| EXPLORER | 90cm | 350 | 0.47$ | 0.369$ | 0.214$ | 1.053$ | 1.090$ | 0.05$ | **1.14$** |

### Коробка: LIFE (340 stems)

| Квітка | Розмір | К-ть | База | +Авіа | +Трак | Сума | ×1.035 | +Под | **Собівартість** |
|--------|--------|------|------|-------|-------|------|--------|------|------------------|
| IGUAZU | 90cm | 75 | 0.95$ | 0.379$ | 0.221$ | 1.550$ | 1.604$ | 0.05$ | **1.65$** |
| CANDELIGHT | 60cm | 40 | 0.65$ | 0.379$ | 0.221$ | 1.250$ | 1.294$ | 0.05$ | **1.34$** |
| DRAGON FLY | 70cm | 50 | 0.45$ | 0.379$ | 0.221$ | 1.050$ | 1.087$ | 0.05$ | **1.14$** |
| IGUAZU | 80cm | 150 | 0.85$ | 0.379$ | 0.221$ | 1.450$ | 1.501$ | 0.05$ | **1.55$** |
| IGUAZU | 90cm | 25 | 0.95$ | 0.379$ | 0.221$ | 1.550$ | 1.604$ | 0.05$ | **1.65$** |

### Коробка: EDANA (500 stems)

| Квітка | Розмір | К-ть | База | +Авіа | +Трак | Сума | ×1.035 | +Под | **Собівартість** |
|--------|--------|------|------|-------|-------|------|--------|------|------------------|
| NINA | 60cm | 50 | 0.40$ | 0.258$ | 0.150$ | 0.808$ | 0.836$ | 0.05$ | **0.89$** |
| PINK FLOYD | 60cm | 50 | 0.40$ | 0.258$ | 0.150$ | 0.808$ | 0.836$ | 0.05$ | **0.89$** |
| KHELA | 70cm | 150 | 0.45$ | 0.258$ | 0.150$ | 0.858$ | 0.888$ | 0.05$ | **0.94$** |
| MALIBU | 80cm | 100 | 0.45$ | 0.258$ | 0.150$ | 0.858$ | 0.888$ | 0.05$ | **0.94$** |
| POMAROSA | 80cm | 100 | 0.50$ | 0.258$ | 0.150$ | 0.908$ | 0.940$ | 0.05$ | **0.99$** |
| COUNTRY HOME | 60cm | 50 | 0.40$ | 0.258$ | 0.150$ | 0.808$ | 0.836$ | 0.05$ | **0.89$** |

---

## Підсумок

| Показник | Значення |
|----------|----------|
| Всього квіток | 2665 шт |
| Базова вартість (PRECIO) | 1467.75$ |
| Transport | 903.01$ |
| Загальна вартість | 2370.76$ |

---

## Детальний приклад розрахунку

**FREEDOM 90cm (коробка EVERBLOOM s o)**

```
Вхідні дані:
  - basePrice = 0.62$
  - transport = 903.01$
  - totalBoxes = 7
  - stemsInBox = 350 (всі квітки в цій коробці)
  - truckCostPerBox = 75$
  - transferFeePercent = 3.5%
  - taxPerStem = 0.05$

Розрахунок:
  1. airPerBox = 903.01 / 7 = 129.00$
  2. airPerStem = 129.00 / 350 = 0.3686$
  3. truckPerStem = 75 / 350 = 0.2143$
  4. subtotal = 0.62 + 0.3686 + 0.2143 = 1.2029$
  5. withFee = 1.2029 × 1.035 = 1.2450$
  6. fullCost = 1.2450 + 0.05 = 1.2950$
  7. rounded = 1.29$

Результат: 1.29$ за квітку
```

---

## Відображення в UI

При наведенні на ціну в таблиці preview показується тултіп:

```
База: 0.62$ + Авіа: 0.37$ + Трак: 0.21$ × 1.035 + Под: 0.05$ = 1.29$
```
